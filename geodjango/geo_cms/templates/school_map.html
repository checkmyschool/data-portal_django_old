<html lang = "en">
    <head>
        {% load staticfiles %}
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="{% static "css/reset.css" %}">
        <link rel="stylesheet" type="text/css" href="{% static "css/school_map_style.css" %}">
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
        <link href="https://fonts.googleapis.com/css?family=Roboto|Bitter|Lobster" rel="stylesheet">
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0">

        <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
    </head>

    <header style="background-color: #002036; height: 100px;">
        <div class="logo">
            <!--<img id="logo" src="{% static "myapp/cms_logo.png" %}"/>-->
            <h2 style="margin-top:10px; text-align: center; color:#ecc700; font-size: 25px;"><a href="/">CheckMySchool Data Portal</a></h2>
            <h4 style="padding:20px; text-align: center; color:#ffffff; font-size: 20px;">For the Citizen Monitoring <br> of Philippine Public Schools</h4>
        </div>
        <nav>
            <ul>
                <li style="color: #ffffff;"><a href="/about/">About</a></li>
                <li style="color: #ffffff;"><a href="/schools_list/">School Profiles</a></li>
                <li style="color: #ffffff;"><a href="/school_map/">School Map</a></li>
                <li style="color: #ffffff;"><a href="/table_creator/">Create Your Own Dataset</a></li>
            </ul>
        </nav>
    </header>

    <section style="height:250; background-color: #ffffff;">
        <h2>School Selection Filters</h2>
        <form action="" method="get">
            {{ filter.form.as_p }}
            <input type="submit" />
        </form>

    </section>


<body>

<div id="map" style="width:100%; height:100%;"></div>

<script type="text/javascript">
    var map = L.map('map').setView([12.8797, 121.7740], 5);
    var osmLayer = new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 18,
        attribution: 'Data, imagery and map information provided by <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> and contributors.'
    });
    map.addLayer(osmLayer);
    var data = {
        "type": "FeatureCollection",
        "features": [
        {% for obj in filter.qs %}
        {
            "type": "Feature",
            "properties": {
                "School_Name": "{{ obj.school_name }}",
                "School_ID": "{{ obj.school_id }}",
                "Region": "{{ obj.region }}",
                "District": "{{ obj.district }}"
            },
            "geometry": {
                "type": "Point",
                "coordinates": [{{ obj.longitude }}, {{ obj.latitude }}]
            }
        }{% if not loop.last %},{% endif %}
        {% endfor %}
        ]
    };
    var blackIcon = L.Icon.extend({
        options: {
            iconUrl: "{% static "myapp/marker-24.png" %}",
            iconSize: [24,24]
        }
    });
    var dataLayer = L.geoJson(data, {
        pointToLayer: function(feature, latlng) {
            return L.marker(latlng, {icon: new blackIcon()});
        },
        onEachFeature: function(feature, layer) {
            layer.bindPopup("<dl><dt><b>School Properties</b></dt>" +
                "<dt>" + "School Name: " +
                '<a href="' + schools_list/feature.properties.School_ID + '/" style="font-size:15px;">' +
                    feature.properties.School_Name + 
                '</a>' + "</dt>" +
                "<dt>" + "Schoool ID: " + feature.properties.School_ID + "</dt>" + 
                "<dt>" + "Region: " + feature.properties.Region + "</dt>" +
                "<dt>" + "District: " + feature.properties.District + "</dt>" +
                "</dl>"
            );
        }
    });
    map.addLayer(dataLayer);
</script>

<section style="height: 20px; background-color: #ffffff"></section>

<footer style="background-color: #002036; height:250px;">
    <div>
        <a href="https://github.com/heatherbaier/cms_django"><i class="fa fa-github fa-3x" aria-hidden="true"></i></a>
        <a href="https://www.youtube.com/user/onlinecms"><i class="fa fa-youtube fa-3x" aria-hidden="true"></i></a>
        <a href="https://twitter.com/onlinecms"><i class="fa fa-twitter fa-3x" aria-hidden="true"></i></a>
        <a href="https://www.facebook.com/CheckMySchool/"><i class="fa fa-facebook fa-3x" aria-hidden="true"></i></a>
        <a href="info@checkmyschool.org"><i class="fa fa-envelope fa-3x" aria-hidden="true"></i></a>
    </div>
    <h4 style="color:white">
        ANSA-EAP Satellite Office, 3rd Floor Mansi Bldg, 337 Katipunan Avenue Loyola <br>
        Heights, Quezon City, Metro Manila Philippines 1108
    </h4>
</footer>

</body>

</html>
